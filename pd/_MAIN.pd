#N canvas 1490 119 416 685 12;
#X declare -path ./bop;
#X declare -path ./bop/babs;
#X declare -path ./bop/babs;
#X obj 32 14 cnv 19 370 40 empty empty ðŸª´\ The\ Musical\ Plants\ ðŸª´ 10 20 0 16 #c6ffc7 #e3c6ff 0;
#X obj 337 33 nbx 3 17 -1e+37 1e+37 0 1 version empty version 0 -10 0 12 #c6ffc7 #000000 #000000 125 256;
#X obj 32 70 cnv 19 370 150 empty empty empty 20 12 0 12 #e3c6ff #404040 0;
#X obj 32 244 cnv 19 370 150 empty empty empty 20 12 0 12 #c6feff #404040 0;
#X text 37 248 VOICES;
#N canvas 0 145 1748 1159 mapping 0;
#X msg 1214 198 \$1 10;
#X obj 1214 226 line~;
#X msg 1471 209 \$1 10;
#X obj 1471 237 line~;
#X obj 739 499 s osc-in;
#X obj 62 417 s calibrate;
#X obj 60 273 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 439 432 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 739 411 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 438 492 s \$0-nextvoice;
#X obj 1214 410 s~ amp1;
#X obj 1396 412 s~ amp2;
#X obj 740 242 sel 0 1, f 13;
#X obj 785 279 delay 2000;
#X obj 785 399 s osc-in;
#X obj 785 311 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X text 735 67 red \; press to reboot \; hold for 2s to shutdown \;;
#X text 60 80 green \; calibrate \;;
#X msg 1298 140 0.5;
#X obj 1298 116 loadbang;
#X obj 38 225 sel 0 1;
#X obj 438 233 sel 0 1, f 16;
#X obj 490 311 delay 2000;
#X obj 493 424 s osc-in;
#X obj 490 343 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 449 263 stop;
#X text 434 53 blue \; press next voice \; hold for 2s to update \;;
#X obj 1214 132 r pots;
#X msg 1214 156 \$1;
#X msg 1471 166 \$2;
#X obj 1471 137 r pots;
#X obj 39 126 r buttons;
#X msg 39 150 \$1;
#X obj 437 133 r buttons;
#X msg 437 157 \$2;
#X obj 739 140 r buttons;
#X msg 739 164 \$3;
#X obj 100 780 r from-arduino;
#X obj 351 887 s buttons;
#X obj 100 834 route t traw b p, f 52;
#X obj 100 883 route 0 1, f 23;
#X msg 100 915 \$1;
#X msg 222 919 \$1;
#X obj 370 980 filtering;
#X obj 450 980 filtering;
#X obj 99 1014 s sensor1;
#X obj 222 1014 s sensor2;
#X obj 432 885 s pots;
#X obj 1477 813 r osc-in;
#X obj 1477 837 route debug;
#X obj 1409 786 r from-arduino;
#X obj 1417 896 route traw;
#X obj 1417 924 route 0 1;
#X obj 1414 988 pack;
#X msg 1431 1021 debug \$1 \$2;
#X obj 1431 1059 s osc-out;
#X obj 1417 865 babs.gate;
#X msg 1413 953 \$1;
#X msg 1444 954 \$1;
#X obj 99 979 filter-and-scale;
#X obj 222 978 filter-and-scale;
#X obj 581 842 r osc-in;
#X obj 585 991 s sensitivity;
#X obj 712 994 s floor;
#X text 584 819 set sensitivity;
#X obj 581 866 route sens sensitivity floor;
#X obj 1239 916 pack;
#X obj 1219 857 r sensor1;
#X obj 1305 856 r sensor2;
#X msg 1249 1030 debug \$1 \$2;
#X obj 1249 1068 s osc-out;
#X obj 1247 980 babs.gate;
#X obj 1292 927 r osc-in;
#X obj 1292 951 route debug;
#X text 1225 835 scaled debug;
#X text 1415 758 raw debug;
#X obj 798 865 loadbang;
#X obj 798 889 delay 2000;
#X obj 1314 222 r pots;
#X msg 1314 246 \$3;
#X obj 1304 341 line~;
#X msg 1303 312 \$1 10;
#X obj 1214 379 *~, f 5;
#X obj 1396 384 *~;
#X text 1298 78 pot3 \; master gain;
#X text 1469 99 pot2 \; gain R;
#X text 1213 92 pot1 \; gain L;
#X obj 1314 274 expr $f1 * 3 + 0.5;
#X msg 785 372 helper shutdown;
#X msg 739 472 herlper reboot;
#X msg 493 397 herlper update;
#X obj 39 188 change;
#X obj 438 192 change;
#X obj 741 203 change;
#X msg 777 921 10;
#X msg 848 939 0.02;
#X obj 996 740 r osc-in;
#X obj 996 764 route id;
#X obj 996 788 s ID;
#X obj 505 371 s click;
#X obj 460 465 s click;
#X obj 72 309 s click;
#X obj 59 352 delay 3000;
#X obj 75 385 s click;
#X obj 754 444 s click;
#X obj 797 345 s click;
#X obj 999 889 r osc-in;
#X obj 999 913 route backing;
#X obj 999 1007 s bg-gain;
#X obj 1022 946 loadbang;
#X text 996 849 set backing;
#X text 995 709 set ID;
#X obj 97 647 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 97 623 metro 1 1 min;
#X obj 173 595 * 60;
#X obj 101 509 loadbang;
#X text 83 479 calibrate every n hours;
#X msg 101 568 1;
#X obj 97 685 s calibrate;
#X msg 178 562 6;
#X obj 267 582 r osc-in;
#X obj 267 606 route calibrate;
#X obj 270 639 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 270 677 s calibrate;
#X text 256 549 calibrate;
#X msg 1015 978 0;
#X connect 0 0 1 0;
#X connect 1 0 82 0;
#X connect 2 0 3 0;
#X connect 3 0 83 1;
#X connect 6 0 101 0;
#X connect 6 0 102 0;
#X connect 7 0 9 0;
#X connect 7 0 100 0;
#X connect 8 0 89 0;
#X connect 8 0 104 0;
#X connect 12 0 8 0;
#X connect 12 1 13 0;
#X connect 13 0 15 0;
#X connect 15 0 88 0;
#X connect 15 0 105 0;
#X connect 18 0 0 0;
#X connect 18 0 2 0;
#X connect 18 0 81 0;
#X connect 19 0 18 0;
#X connect 20 1 6 0;
#X connect 21 0 7 0;
#X connect 21 0 25 0;
#X connect 21 1 22 0;
#X connect 22 0 24 0;
#X connect 24 0 90 0;
#X connect 24 0 99 0;
#X connect 25 0 22 0;
#X connect 27 0 28 0;
#X connect 28 0 0 0;
#X connect 29 0 2 0;
#X connect 30 0 29 0;
#X connect 31 0 32 0;
#X connect 32 0 91 0;
#X connect 33 0 34 0;
#X connect 34 0 92 0;
#X connect 35 0 36 0;
#X connect 36 0 93 0;
#X connect 37 0 39 0;
#X connect 39 1 40 0;
#X connect 39 2 38 0;
#X connect 39 3 47 0;
#X connect 40 0 41 0;
#X connect 40 1 42 0;
#X connect 41 0 59 0;
#X connect 42 0 60 0;
#X connect 48 0 49 0;
#X connect 49 0 56 1;
#X connect 51 0 52 0;
#X connect 52 0 57 0;
#X connect 52 1 58 0;
#X connect 53 0 54 0;
#X connect 54 0 55 0;
#X connect 56 0 51 0;
#X connect 57 0 53 0;
#X connect 58 0 53 1;
#X connect 59 0 45 0;
#X connect 60 0 46 0;
#X connect 61 0 65 0;
#X connect 65 0 62 0;
#X connect 65 1 62 0;
#X connect 65 2 63 0;
#X connect 66 0 71 0;
#X connect 67 0 66 0;
#X connect 68 0 66 1;
#X connect 69 0 70 0;
#X connect 71 0 69 0;
#X connect 72 0 73 0;
#X connect 73 0 71 1;
#X connect 76 0 77 0;
#X connect 77 0 94 0;
#X connect 77 0 95 0;
#X connect 78 0 79 0;
#X connect 79 0 87 0;
#X connect 80 0 82 1;
#X connect 80 0 83 0;
#X connect 81 0 80 0;
#X connect 82 0 10 0;
#X connect 83 0 11 0;
#X connect 87 0 81 0;
#X connect 88 0 14 0;
#X connect 89 0 4 0;
#X connect 90 0 23 0;
#X connect 91 0 20 0;
#X connect 92 0 21 0;
#X connect 93 0 12 0;
#X connect 94 0 62 0;
#X connect 95 0 63 0;
#X connect 96 0 97 0;
#X connect 97 0 98 0;
#X connect 102 0 5 0;
#X connect 102 0 103 0;
#X connect 106 0 107 0;
#X connect 107 0 108 0;
#X connect 109 0 125 0;
#X connect 112 0 118 0;
#X connect 113 0 112 0;
#X connect 114 0 113 1;
#X connect 115 0 119 0;
#X connect 115 0 117 0;
#X connect 117 0 113 0;
#X connect 119 0 114 0;
#X connect 120 0 121 0;
#X connect 121 0 122 0;
#X connect 122 0 123 0;
#X connect 125 0 108 0;
#X restore 273 192 pd mapping;
#X f 16;
#X obj 32 416 cnv 19 370 250 empty empty empty 20 12 0 12 #feffc6 #404040 0;
#X obj 213 605 declare -path ./bop, f 24;
#X obj 45 634 dac~, f 12;
#X msg 313 559 \; pd dsp 1;
#X obj 313 520 loadbang, f 9;
#X obj 45 437 catch~ left;
#X obj 157 436 catch~ right;
#X obj 157 487 bop.reverb~;
#A saved size 0.592857;
#A saved damp 0.835714;
#A saved cutoff 5000;
#A saved wet 0.857143;
#A saved dry 1;
#X obj 213 634 declare -path ./bop/babs;
#X obj 157 560 *~;
#X obj 45 560 *~;
#X obj 63 526 r~ amp1;
#X obj 175 529 r~ amp2;
#X obj 273 108 bopos.arduino, f 16;
#X obj 188 191 bopos.osc, f 10;
#X obj 273 163 bopos.feedback, f 16;
#X obj 273 134 s from-arduino, f 16;
#X obj 46 79 hsl 162 19 0 1 0 0 sensor1 empty sensor1 10 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 46 98 hsl 162 19 0 1 0 0 sensor2 empty sensor2 10 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 46 179 bng 19 250 50 0 calibrate calibrate calibrate 21 10 0 12 #fcfcfc #000000 #000000;
#X obj 46 135 nbx 4 17 0 50 0 0 sensitivity sensitivity sensitvity 55 8 0 12 #fcfcfc #000000 #000000 0 256;
#X obj 46 152 nbx 4 17 0 1 0 0 floor empty floor 55 8 0 12 #fcfcfc #000000 #000000 0 256;
#X obj 45 601 clip~ -1 1;
#X obj 128 600 clip~ -1 1;
#X obj 45 488 bop.reverb~;
#A saved size 0.592857;
#A saved damp 0.835714;
#A saved cutoff 5000;
#A saved wet 0.857143;
#A saved dry 1;
#X msg 188 165 id 0;
#N canvas 467 212 1301 1173 voice-manager 0;
#X obj 638 651 babs.counter, f 16;
#X obj 640 267 file handle;
#X obj 729 155 file which;
#X obj 729 191 unpack s f;
#X msg 729 119 symbol persist/voice.txt;
#X obj 640 15 loadbang;
#X floatatom 640 429 5 0 0 0 - - - 0;
#X obj 640 48 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X msg 729 222 open \$1;
#X msg 640 148 1 \, close;
#X obj 714 308 print file-write;
#X text 844 188 read voice from file at load;
#X obj 640 113 delay 5;
#X obj 639 579 s \$0-nextvoice;
#X obj 638 622 r \$0-nextvoice;
#X obj 653 370 r osc-in;
#X obj 639 541 t b f, f 16;
#X obj 653 394 route voice;
#X text 725 369 receive voice as OSC command;
#X obj 17 38 bng 19 250 50 0 \$0-nextvoice \$0-nextvoice next\ voice 24 10 0 12 #fcfcfc #000000 #000000;
#X floatatom 637 695 5 0 0 0 - - - 0;
#X floatatom 636 852 5 0 0 0 - - - 0;
#X obj 909 20 declare -path ./bop/babs;
#N canvas 150 308 459 786 get-voice-from-persist 0;
#X obj 126 189 file which;
#X obj 126 225 unpack s f;
#X msg 126 153 symbol persist/voice.txt;
#X obj 126 289 file handle;
#X msg 126 249 open \$1;
#X msg 36 188 1024 \, close;
#X obj 125 331 babs.iter;
#X obj 88 81 t b b b b, f 36;
#X obj 214 546 pow, f 6;
#X msg 213 492 10;
#X floatatom 214 570 5 0 0 0 - - - 0;
#X obj 131 375 t f b;
#X obj 135 446 - 48;
#X obj 149 599 * 1;
#X obj 133 544 t f b;
#X obj 110 652 babs.accum, f 41;
#X obj 350 161 t b b;
#X obj 109 699 babs.listsum;
#X obj 263 317 list length;
#X msg 299 407 set \$1;
#X floatatom 276 462 5 0 0 0 - - - 0;
#X obj 276 485 t f f;
#X obj 355 530 - 1;
#X obj 261 360 - 1;
#X obj 233 272 t l l;
#X obj 90 33 inlet;
#X obj 109 741 outlet;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 2 0 0 0;
#X connect 3 0 24 0;
#X connect 4 0 3 0;
#X connect 5 0 3 0;
#X connect 6 0 11 0;
#X connect 7 0 15 0;
#X connect 7 1 5 0;
#X connect 7 2 2 0;
#X connect 7 3 16 0;
#X connect 8 0 10 0;
#X connect 9 0 8 0;
#X connect 10 0 13 1;
#X connect 11 0 12 0;
#X connect 11 1 20 0;
#X connect 12 0 14 0;
#X connect 13 0 15 0;
#X connect 14 0 13 0;
#X connect 14 1 9 0;
#X connect 15 0 17 0;
#X connect 16 1 15 1;
#X connect 17 0 26 0;
#X connect 18 0 23 0;
#X connect 19 0 20 0;
#X connect 20 0 21 0;
#X connect 21 0 8 1;
#X connect 21 1 22 0;
#X connect 22 0 19 0;
#X connect 23 0 19 0;
#X connect 24 0 6 0;
#X connect 24 1 18 0;
#X connect 25 0 7 0;
#X restore 1241 91 pd get-voice-from-persist;
#X obj 1243 58 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X floatatom 1241 115 5 0 0 0 - - - 0;
#X msg 698 809 201;
#X obj 640 488 clip 0 255;
#X text 1292 118 this parses multiple decimal places for human readable persistance, f 22;
#X obj 1113 421 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X floatatom 1113 474 5 0 0 0 - - - 0;
#X obj 637 810 % 255;
#X obj 636 888 t f f;
#N canvas 208 366 450 300 set-voice-persist 0;
#X obj 63 253 file handle;
#X obj 169 146 file which;
#X obj 169 182 unpack s f;
#X msg 169 110 symbol persist/voice.txt;
#X msg 169 213 open \$1 c;
#X msg 63 134 close;
#X obj 11 70 t f b f b, f 23;
#X text 272 172 save voice to file;
#X obj 19 17 inlet;
#X connect 1 0 2 0;
#X connect 2 0 4 0;
#X connect 3 0 1 0;
#X connect 4 0 0 0;
#X connect 5 0 0 0;
#X connect 6 1 5 0;
#X connect 6 2 0 0;
#X connect 6 3 3 0;
#X connect 8 0 6 0;
#X restore 679 951 pd set-voice-persist;
#X obj 640 75 t b b b, f 68;
#X symbolatom 17 68 13 0 0 0 - active-voice-name - 0;
#N canvas 1971 325 557 748 load-voices 0;
#X obj 135 265 pdcontrol;
#X msg 136 227 dir;
#X obj 135 397 file glob;
#X obj 135 447 list split 1;
#X msg 158 133 clear;
#X obj 98 91 t b b b b;
#X obj 113 585 outlet;
#X obj 100 54 inlet;
#X obj 158 165 text define voices;
#X obj 135 520 text set voices 1e+10;
#X obj 113 561 text size voices;
#X obj 135 373 makefilename %s/voices/*;
#X obj 243 435 print;
#X obj 229 489 makefilename;
#X connect 0 0 11 0;
#X connect 1 0 0 0;
#X connect 2 0 3 0;
#X connect 2 0 12 0;
#X connect 3 0 9 0;
#X connect 4 0 8 0;
#X connect 5 1 10 0;
#X connect 5 2 1 0;
#X connect 5 3 4 0;
#X connect 7 0 5 0;
#X connect 10 0 6 0;
#X connect 11 0 2 0;
#X restore 1113 450 pd load-voices;
#X obj 545 80 tgl 19 0 empty empty mute 22 10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 734 1604 s pd-\$0-active-voice;
#X msg 939 1186 clear;
#X obj 619 1170 text get voices;
#X obj 619 1020 t f b, f 34;
#X obj 588 1281 file split;
#X obj 618 1337 list length;
#X obj 585 1309 t l l;
#X obj 585 1411 babs.nth;
#X obj 618 1361 - 1;
#X obj 588 1235 file splitext;
#X msg 684 1518 obj 10 10 voices/\$1;
#X obj 588 1476 symbol;
#X obj 552 1564 s active-voice-name;
#N canvas 1869 924 260 71 \$0-active-voice 1;
#X obj 10 10 voices/voice.4;
#X restore 13 126 pd \$0-active-voice;
#X obj 175 257 s pd-\$0-active-voice;
#X msg 176 223 vis 1;
#X obj 110 67 bng 19 250 50 0 \$0-active-voice-vis empty open 22 10 0 12 #fcfcfc #000000 #000000;
#X obj 176 192 r \$0-active-voice-vis;
#X obj 188 69 bng 19 250 50 0 \$0-reload-voices empty reload\ voices 22 10 0 12 #fcfcfc #000000 #000000;
#X obj 684 45 r \$0-reload-voices;
#X connect 0 0 20 0;
#X connect 1 0 6 0;
#X connect 1 1 10 0;
#X connect 2 0 3 0;
#X connect 3 0 8 0;
#X connect 4 0 2 0;
#X connect 5 0 7 0;
#X connect 6 0 27 0;
#X connect 7 0 34 0;
#X connect 8 0 1 0;
#X connect 9 0 1 0;
#X connect 12 0 9 0;
#X connect 14 0 0 0;
#X connect 15 0 17 0;
#X connect 16 0 13 0;
#X connect 16 1 0 1;
#X connect 17 0 6 0;
#X connect 20 0 31 0;
#X connect 21 0 32 0;
#X connect 23 0 25 0;
#X connect 24 0 23 0;
#X connect 27 0 16 0;
#X connect 29 0 36 0;
#X connect 30 0 31 1;
#X connect 31 0 21 0;
#X connect 32 0 41 0;
#X connect 32 1 33 0;
#X connect 34 0 12 0;
#X connect 34 1 4 0;
#X connect 34 2 29 0;
#X connect 36 0 30 0;
#X connect 39 0 38 0;
#X connect 40 0 47 0;
#X connect 41 0 40 0;
#X connect 41 1 39 0;
#X connect 42 0 44 0;
#X connect 43 0 46 0;
#X connect 44 0 45 0;
#X connect 44 1 43 0;
#X connect 45 0 49 0;
#X connect 46 0 45 1;
#X connect 47 0 42 0;
#X connect 48 0 38 0;
#X connect 49 0 48 0;
#X connect 49 0 50 0;
#X connect 53 0 52 0;
#X connect 55 0 53 0;
#X connect 57 0 7 0;
#X coords 0 -1 1 1 300 85 1 10 10;
#X restore 40 289 pd voice-manager;
#X obj 314 436 backing;
#X connect 10 0 9 0;
#X connect 11 0 30 0;
#X connect 12 0 13 0;
#X connect 13 0 29 0;
#X connect 15 0 29 0;
#X connect 16 0 28 0;
#X connect 17 0 16 1;
#X connect 18 0 15 1;
#X connect 19 0 22 0;
#X connect 28 0 8 0;
#X connect 29 0 8 1;
#X connect 30 0 16 0;
#X connect 31 0 20 0;
